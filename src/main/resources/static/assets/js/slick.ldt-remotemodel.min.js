function saveGrid(){var a=containerurl;if(subjecturi!==""){a=a+"?subject="+encodeURIComponent(pSubjectUri)}loader.saveData(a,context)}function saveChangedGrid(){var a=containerurl;if(subjecturi!==""){a=a+"?subject="+encodeURIComponent(pSubjectUri)}loader.saveChangedData(a,context)}function statusFormatter(f,a,e,d,c){var b="";if(e===1){b="<img src='"+staticroot+"/css/images/tick.png'>"}else{if(e===2){b="<img src='"+staticroot+"/css/images/tag_red.png'>"}}return b}(function(b){function a(k,i){var s=50;var F=[];var o=[];var p="";var e=null;var v=1;var j=null;var d=null;var m=k;var x={};if(i!==""){m=m+"?subject="+encodeURIComponent(i)}var C=new Slick.Event();var w=new Slick.Event();var y=new Slick.Event();var G=new Slick.Event();function D(){}function E(H){if(H.hasOwnProperty("status")){if(H.status==0){alert("Connection lost - please try again")}else{if(H.hasOwnProperty("responseText")){alert(H.status+": "+H.responseText)}else{alert("Error: "+H.status+"(sorry, don't have more information)")}}}else{alert("Connection lost - please try again")}}function u(J,I){for(var H=J;H<=I;H++){if(F[H]==undefined||F[H]==null){return false}}return true}function z(){for(var H in F){delete F[H]}F.length=0}function t(I){var H=new Date(Date.now());o.push({"@id":F[I]["@id"],"http://www.w3.org/ns/prov#invalidatedAtTime":H.toISOString()});F.splice(I,1)}function h(L,K){if(d){d.abort();for(var H=d.fromPage;H<=d.toPage;H++){F[H*s]=undefined}}if(L<0){L=0}if(F.length>0){K=Math.min(K,F.length-1)}var J=Math.floor(L/s);var I=Math.floor(K/s);while(F[J*s]!==undefined&&J<I){J++}while(F[I*s]!==undefined&&J<I){I--}if(J>I||((J==I)&&F[J*s]!==undefined)){w.notify({from:L,to:K});return}if(j!=null){clearTimeout(j)}j=setTimeout(function(){for(var M=J;M<=I;M++){F[M*s]=null}C.notify({from:L,to:K});d=b.ajax({cache:false,headers:{Accept:"application/ld+json"},datatype:"json",url:m,success:n,error:function(N){r(N,J,I)}});d.fromPage=J;d.toPage=I},50)}function r(J,I,H){E(J);w.notify({from:0,to:0})}function n(M){var T=0;var J=M["@context"];for(var W in J){if(typeof J[W]==="object"){var Q=W.indexOf(":");if(Q>0){var P=W.substring(0,Q);var I=W.substring(Q+1);var L=J[P];if(L!==""){x[L+I]=true}}}}if("graph" in M){to=T+M.graph.length;F.length=M.graph.length;for(var N=0;N<M.graph.length;N++){var K=M.graph[N];var W={};for(var V in K){if(K.hasOwnProperty(V)){var Q=V.indexOf(":");var H=V;if(Q>0){var P=V.substring(0,Q);var I=V.substring(Q+1);var L=J[P];if(L!==""){H=L+I}}else{var O=J[V];if(O!==""){H=O}}W[H]=K[V]}}for(var U in fragments){if(fragments.hasOwnProperty(U)){if(fragments[U]===U){for(var S in templateItem){if(templateItem.hasOwnProperty(S)&&W.hasOwnProperty(S)){if(templateItem[S].indexOf("{"+U+"}")>0){var R=new RegExp("^"+templateItem[S].replace("{"+U+"}","(.+)")+"$","g");W[U]=W[S].replace(R,"$1")}}}}}}F[T+N]=W;F[T+N].index=T+N;F[T+N]["#"]=0}}else{if("@id" in M){to=T+1;var K=M;var W={};for(var V in K){if(K.hasOwnProperty(V)&&V!=="@context"){var Q=V.indexOf(":");var H=V;if(Q>0){var P=V.substring(0,Q);var I=V.substring(Q+1);var L=J[P];if(L!==""){H=[L+I]}}W[H]=K[V]}}for(var U in fragments){if(fragments.hasOwnProperty(U)){if(fragments[U]===U){W[U]="calc"}}}F[T]=W;F[T].index=T;F[T]["#"]=0}else{if(b.isArray(M)){to=T+M.length;F.length=M.length;for(var N=0;N<M.length;N++){var K=M[N];var W={};for(var V in K){if(K.hasOwnProperty(V)){var H=V;if(H==="@type"){H="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}var S=K[V];if(b.isArray(S)){S=S[0]}if(typeof S==="object"){if(S.hasOwnProperty("@value")){W[H]=S["@value"]}if(S.hasOwnProperty("@id")){W[H]=S["@id"]}}else{W[H]=S}}}for(var U in fragments){if(fragments.hasOwnProperty(U)){if(fragments[U]===U){for(var S in templateItem){if(templateItem.hasOwnProperty(S)&&W.hasOwnProperty(S)){if(templateItem[S].indexOf("{"+U+"}")>0){var R=new RegExp("^"+templateItem[S].replace("{"+U+"}","(.+)")+"$","g");W[U]=W[S].replace(R,"$1")}}}}}}F[T+N]=W;F[T+N].index=T+N;F[T+N]["#"]=0}}else{to=T}}}d=null;w.notify({from:T,to:to})}function l(J,I){for(var H=J;H<=I;H++){delete F[H]}h(J,I)}function g(I,H){e=I;v=H;z()}function f(H){p=H;z()}function c(I,J,H){J["#"]=1;for(var K in H){if(H.hasOwnProperty(K)){J[K]=H[K]}}J["@id"]=UUIDjs.create().toURN();F.push(J);q(F.length-1);I.invalidateRow(F.length-1);I.updateRowCount();I.render()}function q(L){for(var K in templateItem){if(templateItem.hasOwnProperty(K)){var J=templateItem[K];for(var I in fragments){if(fragments.hasOwnProperty(I)){if(J.indexOf("{"+I+"}")>0){if(F[L].hasOwnProperty(fragments[I])){var H=F[L][fragments[I]];if(H!==""){J=J.replace("{"+I+"}",H)}else{J=""}}else{J=""}}}}}if(J===""){delete F[L][K]}else{F[L][K]=J}}}function A(J,K){var I={};for(var L in K){if(K.hasOwnProperty(L)){if(typeof K[L]==="object"){I[L]={"@type":"@id"}}else{I[L]=K[L]}}}for(var L in x){if(x.hasOwnProperty(L)){I[L]={"@type":"@id"}}}var H={"@context":I,graph:F};y.notify();b.ajax({type:"PUT",contentType:"application/ld+json",url:J,data:JSON.stringify(H),success:function(){for(var M=0;M<F.length;M++){F[M]["#"]=0}grid.invalidateAllRows();grid.render();G.notify()},error:function(M){E(M);G.notify()}})}function B(H,I){function J(S){return(S["#"]===1)}function L(S){return(S["#"]===2)}function O(){P--;if(P===0){P=-1;for(var S=0;S<F.length;S++){F[S]["#"]=0}o.splice(0,o.length);grid.invalidateAllRows();grid.render();G.notify()}}var Q={};for(var R in I){if(I.hasOwnProperty(R)){if(typeof I[R]==="object"){Q[R]={"@type":"@id"}}else{Q[R]=I[R]}}}for(var R in x){if(x.hasOwnProperty(R)){Q[R]={"@type":"@id"}}}var K={"@context":Q,graph:F.filter(J)};var N={"@context":Q,graph:F.filter(L)};var M={"@context":Q,graph:o};var P=0;if(M.graph.length>0){P++}if(K.graph.length>0){P++}if(N.graph.length>0){P++}if(P>0){y.notify()}if(M.graph.length>0){b.ajax({type:"DELETE",contentType:"application/ld+json",url:H,data:JSON.stringify(M),success:O,error:function(S){E(S);G.notify()}})}if(K.graph.length>0){b.ajax({type:"POST",contentType:"application/ld+json",url:H,data:JSON.stringify(K),success:O,error:function(S){E(S);G.notify()}})}if(N.graph.length>0){b.ajax({type:"PUT",contentType:"application/ld+json",url:H,data:JSON.stringify(N),success:O,error:function(S){E(S);G.notify()}})}}D();return{data:F,clear:z,isDataLoaded:u,ensureData:h,reloadData:l,setSort:g,setSearch:f,addRow:c,removeRow:t,updateRow:q,saveData:A,saveChangedData:B,onDataLoading:C,onDataLoaded:w,onDataSaving:y,onDataSaved:G}}b.extend(true,window,{Slick:{Data:{RemoteModel:a}}})})(jQuery);